<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,initial-scale=1">

{%- liquid
  assign og_title = page_title | default: shop.name
  assign og_url = canonical_url | default: request.origin
  assign og_type = 'website'
  assign og_description = page_description | default: shop.description | default: shop.name

  if request.page_type == 'product'
    assign og_type = 'product'
  elsif request.page_type == 'article'
    assign og_type = 'article'
  elsif request.page_type == 'password'
    assign og_url = request.origin
  endif
%}

<meta
  property="og:site_name"
  content="{{ shop.name }}"
>
<meta
  property="og:url"
  content="{{ og_url }}"
>
<meta
  property="og:title"
  content="{{ og_title | escape }}"
>
<meta
  property="og:type"
  content="{{ og_type }}"
>
<meta
  property="og:description"
  content="{{ og_description | escape }}"
>

{%- if page_image -%}
  {%- assign og_image_url = page_image | image_url: width: 1200, height: 630 -%}
  <meta
    property="og:image"
    content="https:{{ og_image_url }}"
  >
  <meta
    property="og:image:secure_url"
    content="https:{{ og_image_url }}"
  >
  <meta
    property="og:image:width"
    content="1200"
  >
  <meta
    property="og:image:height"
    content="630"
  >
  <meta
    name="twitter:image"
    content="https:{{ og_image_url }}"
  >
{%- endif -%}

{%- if request.page_type == 'product' -%}
  <script type="application/ld+json">
    {{ product | structured_data }}
  </script>

  <meta
    property="og:price:amount"
    content="{{ product.price | money_without_currency | strip_html }}"
  >
  <meta
    property="og:price:currency"
    content="{{ cart.currency.iso_code }}"
  >
{%- endif -%}

{%- comment -%} Organization structured data {%- endcomment -%}
{%- liquid
  assign social_links = ''
  if settings.social_facebook_link != blank
    assign social_links = social_links | append: settings.social_facebook_link | append: '|'
  endif
  if settings.social_twitter_link != blank
    assign social_links = social_links | append: settings.social_twitter_link | append: '|'
  endif
  if settings.social_instagram_link != blank
    assign social_links = social_links | append: settings.social_instagram_link | append: '|'
  endif
  if settings.social_pinterest_link != blank
    assign social_links = social_links | append: settings.social_pinterest_link | append: '|'
  endif
  if settings.social_youtube_link != blank
    assign social_links = social_links | append: settings.social_youtube_link | append: '|'
  endif
  assign social_links_array = social_links | split: '|'
-%}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": {{ shop.name | json }},
  "url": {{ shop.url | json }}{%- if shop.description != blank -%},
  "description": {{ shop.description | json }}{%- endif -%}{%- if shop.brand.logo -%},
  "logo": {{ shop.brand.logo | image_url: width: 600 | json }}{%- endif -%}{%- if social_links_array.size > 0 -%},
  "sameAs": [
    {%- for link in social_links_array -%}
      {%- if link != blank -%}
        {{ link | json }}{%- unless forloop.last -%},{%- endunless -%}
      {%- endif -%}
    {%- endfor -%}
  ]{%- endif -%}
}
</script>

{%- comment -%} WebSite structured data with search action {%- endcomment -%}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": {{ shop.name | json }},
  "url": {{ shop.url | json }},
  "potentialAction": {
    "@type": "SearchAction",
    "target": {
      "@type": "EntryPoint",
      "urlTemplate": {{ shop.url | append: '/search?q={search_term_string}' | json }}
    },
    "query-input": "required name=search_term_string"
  }
}
</script>

<meta
  name="twitter:card"
  content="summary_large_image"
>
<meta
  name="twitter:title"
  content="{{ og_title | escape }}"
>
<meta
  name="twitter:description"
  content="{{ og_description | escape }}"
>

<title>
  {{ page_title }}
  {%- if current_tags %} &ndash; tagged "{{ current_tags | join: ', ' }}"{% endif -%}
  {%- if current_page != 1 %} &ndash; Page {{ current_page }}{% endif -%}
  {%- unless page_title contains shop.name %} &ndash; {{ shop.name }}{% endunless -%}
</title>

<link
  rel="canonical"
  href="{{ canonical_url }}"
>

{%- liquid
  assign meta_description = page_description | default: shop.description | default: shop.name
-%}
<meta
  name="description"
  content="{{ meta_description | escape }}"
>
