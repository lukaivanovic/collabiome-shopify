{% comment %}
  This section is used in the collection template to render collection page
  listing all products within a collection.

  https://shopify.dev/docs/storefronts/themes/architecture/templates/collection
{% endcomment %}

<div class="container py-8">
  <h1 class=" mb-8">{{ collection.title }}</h1>

  <div class="grid grid-cols-[repeat(auto-fill,minmax(320px,1fr))] gap-4">
    {% for product in collection.products %}
      {% render 'product-card', product: product %}
    {% endfor %}
  </div>
</div>

{%- comment -%} CollectionPage structured data {%- endcomment -%}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": {{ collection.title | json }},
  "description": {{ collection.description | default: collection.title | json }},
  "url": {{ shop.url | append: collection.url | json }},
  "mainEntity": {
    "@type": "ItemList",
    "numberOfItems": {{ collection.products_count | json }},
    "itemListElement": [
      {%- for product in collection.products limit: 20 -%}
      {
        "@type": "ListItem",
        "position": {{ forloop.index | json }},
        "item": {
          "@type": "Product",
          "name": {{ product.title | json }},
          "url": {{ shop.url | append: product.url | json }}{%- if product.featured_media -%},
          "image": {{ product.featured_media | image_url: width: 800 | json }}{%- endif -%}
        }
      }{%- unless forloop.last -%},{%- endunless -%}
      {%- endfor -%}
    ]
  }
}
</script>

{% schema %}
{
  "name": "Collection",
  "settings": []
}
{% endschema %}
