{% comment %}
  This section is used in the blog template to render the blog page listing all
  articles within a blog.

  https://shopify.dev/docs/storefronts/themes/architecture/templates/blog
{% endcomment %}

{% liquid
  assign section_id = section.settings.custom_id | default: section.id
%}

<section id="{{ section_id }}" class="py-16">
  <div class="container mx-auto px-4">
    <header class="max-w-5xl space-y-4 lg:space-y-5">
      <p class="text-xs font-semibold tracking-[0.5em] text-gray-500 uppercase">
        {{ blog.title }}
      </p>
      <h1 class="text-4xl font-semibold leading-tight text-slate-900 lg:text-5xl">
        {{ blog.title }}
      </h1>
      {% if blog.description != blank %}
        <p class="text-lg text-gray-600 max-w-3xl">
          {{ blog.description }}
        </p>
      {% endif %}
    </header>

    {% paginate blog.articles by 15 %}
    <div class="mt-10 grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
      {% for article in blog.articles %}
        <div class="h-full">
          {% render 'blog-article-card',
            article: article,
            card_bg_class: 'bg-product-bg-secondary',
            show_date: true,
            show_author: true,
            show_excerpt: true,
            excerpt_words: 30
          %}
        </div>
      {% endfor %}
    </div>

      {%- if paginate.pages > 1 -%}
        <div class="mt-12">
          {{- paginate | default_pagination -}}
        </div>
      {%- endif -%}
    {% endpaginate %}
  </div>
</section>

{%- comment -%} Blog structured data {%- endcomment -%}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Blog",
  "name": {{ blog.title | json }},
  "description": {{ blog.description | default: blog.title | json }},
  "url": {{ shop.url | append: blog.url | json }},
  "publisher": {
    "@type": "Organization",
    "name": {{ shop.name | json }}{%- if shop.brand.logo -%},
    "logo": {
      "@type": "ImageObject",
      "url": {{ shop.brand.logo | image_url: width: 600 | json }}
    }{%- endif -%}
  },
  "blogPost": [
    {%- for article in blog.articles limit: 10 -%}
    {
      "@type": "BlogPosting",
      "headline": {{ article.title | json }},
      "url": {{ shop.url | append: article.url | json }},
      "datePublished": {{ article.published_at | date: '%Y-%m-%dT%H:%M:%S%z' | json }},
      "dateModified": {{ article.updated_at | date: '%Y-%m-%dT%H:%M:%S%z' | json }}{%- if article.image -%},
      "image": {{ article.image | image_url: width: 1200 | json }}{%- endif -%}
    }{%- unless forloop.last -%},{%- endunless -%}
    {%- endfor -%}
  ]
}
</script>

{% schema %}
{
  "name": "Blog",
  "settings": []
}
{% endschema %}
