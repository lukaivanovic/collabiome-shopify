{% liquid
  assign section_id = section.settings.custom_id | default: section.id
  assign section_title = section.settings.title
  assign section_description = section.settings.description
  assign columns = section.settings.columns | default: 3

  if columns == 3
    assign grid_cols_class = 'md:grid-cols-3'
  elsif columns == 4
    assign grid_cols_class = 'md:grid-cols-4'
  elsif columns == 5
    assign grid_cols_class = 'md:grid-cols-5'
  else
    assign grid_cols_class = 'md:grid-cols-3'
  endif
%}

<section id="{{ section_id }}" class="py-16">
  <div class="container mx-auto px-4">
    <div class="max-w-3xl">
      <h2 class="text-3xl font-semibold text-neutral-900">{{ section_title | escape }}</h2>
      {% if section_description != blank %}
        <p class="mt-3 text-base text-neutral-600">{{ section_description | escape }}</p>
      {% endif %}
    </div>

    <div class="mt-12 grid gap-4 {{ grid_cols_class }}">
      {% for block in section.blocks %}
        {% liquid
          assign item_title = block.settings.title
          assign item_description = block.settings.description
          assign item_image = block.settings.image
          assign item_link = block.settings.link
          assign show_button = block.settings.show_button
          assign button_label = block.settings.button_label
        %}
        {% if item_link != blank %}
          <a
            href="{{ item_link }}"
            class="flex flex-col gap-2 border-b border-neutral-200 pb-6 group"
          >
        {% else %}
          <article class="flex flex-col gap-2 border-b border-neutral-200 pb-6">
        {% endif %}
        {% if item_image != blank %}
          <div class="overflow-hidden rounded-lg pb-6">
            {{
              item_image
              | image_url: width: 600, height: 400, crop: 'center'
              | image_tag:
                class: 'w-full h-auto object-cover transition-transform duration-300 group-hover:scale-105',
                alt: item_title,
                loading: 'lazy'
            }}
          </div>
        {% endif %}
        {% if item_title != blank %}
          <h3 class="text-lg font-semibold text-neutral-900 group-hover:text-neutral-700">{{ item_title | escape }}</h3>
        {% endif %}
        {% if item_description != blank %}
          <p class="text-sm text-neutral-500">{{ item_description | escape }}</p>
        {% endif %}
        {% if show_button and button_label != blank %}
          <span class="mt-2 text-sm font-medium text-neutral-900 underline group-hover:text-neutral-700">
            {{ button_label | escape }}
          </span>
        {% endif %}
        {% if item_link != blank %}
          </a>
        {% else %}
          </article>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Three Column Grid",
  "tag": "section",
  "class": "three-column-grid",
  "max_blocks": 6,
  "blocks": [
    {
      "type": "item",
      "name": "Item",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Description"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link"
        },
        {
          "type": "checkbox",
          "id": "show_button",
          "label": "Show link button",
          "default": false
        },
        {
          "type": "text",
          "id": "button_label",
          "label": "Button label",
          "default": "Learn more"
        }
      ]
    }
  ],
  "settings": [
    {
      "type": "text",
      "id": "custom_id",
      "label": "Custom ID",
      "info": "Add a custom ID to this section"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Title"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description"
    },
    {
      "type": "range",
      "id": "columns",
      "label": "Number of columns (desktop)",
      "min": 3,
      "max": 6,
      "step": 1,
      "default": 3,
      "info": "Mobile will always display 1 column"
    }
  ],
  "presets": [
    {
      "name": "Three Column Grid",
      "category": "Layout",
      "blocks": [{ "type": "item" }, { "type": "item" }, { "type": "item" }]
    }
  ]
}
{% endschema %}
