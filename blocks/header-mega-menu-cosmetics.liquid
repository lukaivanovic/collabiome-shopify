{% doc %}
  Header Mega Menu - Cosmetics

  Renders a custom mega menu panel for the cosmetics collection with hardcoded filter links.

  @example
  {% content_for 'block', type: 'header-mega-menu-cosmetics', id: 'mega-menu-cosmetics' %}
{% enddoc %}

{% liquid
  # Prefer explicit cosmetics collection handles, fall back if needed
  assign cosmetics_collection = collections.kozmetika

  # Use featured_products metafield when available, otherwise fall back to collection products
  assign featured_products = blank

  if cosmetics_collection.metafields.custom and cosmetics_collection.metafields.custom.featured_products
    assign featured_products = cosmetics_collection.metafields.custom.featured_products.value
  endif

  if featured_products == blank
    assign featured_products = cosmetics_collection.products
  endif

  unless cosmetics_collection and cosmetics_collection != empty
    break
  endunless
%}

<div
  class="mega-menu-panel pointer-events-none absolute left-0 top-[calc(100%-16px)] w-full aria-[hidden=false]:pointer-events-auto"
  data-mega-menu-panel="{{ cosmetics_collection.handle }}"
  aria-hidden="true"
  {{ block.shopify_attributes }}
>
  <div class="container py-3">
    <div
      class="mega-menu-card rounded-2xl border border-black/12 bg-[var(--color-background-default)]"
      data-mega-menu-card
    >
      <div class="flex flex-row gap-8 p-8">
        <div class="flex flex-col gap-5">
          <div class="flex flex-row justify-between gap-28">
            {% comment %} Tip kože {% endcomment %}
            <div class="flex flex-col gap-3 ">
              <p class="m-0 text-xs font-medium uppercase tracking-wide text-primary/70">Tip kože</p>
              <ul class="m-0 list-none space-y-1 p-0">
                <li>
                  <a
                    href="{{ cosmetics_collection.url }}?filter.p.m.custom.skin_type=dry"
                    class="text-sm text-primary transition-colors duration-200 hover:text-primary/80 no-underline"
                  >
                    Suha
                  </a>
                </li>
                <li>
                  <a
                    href="{{ cosmetics_collection.url }}?filter.p.m.custom.skin_type=oily"
                    class="text-sm text-primary transition-colors duration-200 hover:text-primary/80 no-underline"
                  >
                    Masna
                  </a>
                </li>
                <li>
                  <a
                    href="{{ cosmetics_collection.url }}?filter.p.m.custom.skin_type=combination"
                    class="text-sm text-primary transition-colors duration-200 hover:text-primary/80 no-underline"
                  >
                    Mješovita
                  </a>
                </li>
                <li>
                  <a
                    href="{{ cosmetics_collection.url }}?filter.p.m.custom.skin_type=normal"
                    class="text-sm text-primary transition-colors duration-200 hover:text-primary/80 no-underline"
                  >
                    Normalna
                  </a>
                </li>
                <li>
                  <a
                    href="{{ cosmetics_collection.url }}?filter.p.m.custom.skin_type=sensitive"
                    class="text-sm text-primary transition-colors duration-200 hover:text-primary/80 no-underline"
                  >
                    Osjetljiva
                  </a>
                </li>
              </ul>
            </div>

            {% comment %} Dio rutine {% endcomment %}
            <div class="flex flex-col gap-3">
              <p class="m-0 text-xs font-medium uppercase tracking-wide text-primary/70">Dio rutine</p>
              <ul class="m-0 list-none space-y-1 p-0">
                <li>
                  <a
                    href="{{ cosmetics_collection.url }}?filter.p.m.custom.routine_part=cleanser"
                    class="text-sm text-primary transition-colors duration-200 hover:text-primary/80 no-underline"
                  >
                    Čišćenje lica
                  </a>
                </li>
                <li>
                  <a
                    href="{{ cosmetics_collection.url }}?filter.p.m.custom.routine_part=exfoliation"
                    class="text-sm text-primary transition-colors duration-200 hover:text-primary/80 no-underline"
                  >
                    Eksfolacija lica
                  </a>
                </li>
                <li>
                  <a
                    href="{{ cosmetics_collection.url }}?filter.p.m.custom.routine_part=serum"
                    class="text-sm text-primary transition-colors duration-200 hover:text-primary/80 no-underline"
                  >
                    Serumi
                  </a>
                </li>
                <li>
                  <a
                    href="{{ cosmetics_collection.url }}?filter.p.m.custom.routine_part=moisturizer"
                    class="text-sm text-primary transition-colors duration-200 hover:text-primary/80 no-underline"
                  >
                    Hidratantne kreme
                  </a>
                </li>
                <li>
                  <a
                    href="{{ cosmetics_collection.url }}?filter.p.m.custom.routine_part=night_care"
                    class="text-sm text-primary transition-colors duration-200 hover:text-primary/80 no-underline"
                  >
                    Noćna njega
                  </a>
                </li>
              </ul>
            </div>

            {% comment %} Kožni problemi {% endcomment %}
            <div class="flex flex-col gap-3 ">
              <p class="m-0 text-xs font-medium uppercase tracking-wide text-primary/70">Kožni problemi</p>
              <ul class="m-0 list-none space-y-1 p-0">
                <li>
                  <a
                    href="{{ cosmetics_collection.url }}?filter.p.m.custom.problem_solution=acne"
                    class="text-sm text-primary transition-colors duration-200 hover:text-primary/80 no-underline"
                  >
                    Nečista koža
                  </a>
                </li>
                <li>
                  <a
                    href="{{ cosmetics_collection.url }}?filter.p.m.custom.problem_solution=redness"
                    class="text-sm text-primary transition-colors duration-200 hover:text-primary/80 no-underline"
                  >
                    Crvenilo i nadraženost
                  </a>
                </li>
                <li>
                  <a
                    href="{{ cosmetics_collection.url }}?filter.p.m.custom.problem_solution=clogged_pores"
                    class="text-sm text-primary transition-colors duration-200 hover:text-primary/80 no-underline"
                  >
                    Začepljene pore
                  </a>
                </li>
                <li>
                  <a
                    href="{{ cosmetics_collection.url }}?filter.p.m.custom.problem_solution=enlarged_pores"
                    class="text-sm text-primary transition-colors duration-200 hover:text-primary/80 no-underline"
                  >
                    Proširene pore
                  </a>
                </li>
                <li>
                  <a
                    href="{{ cosmetics_collection.url }}?filter.p.m.custom.problem_solution=discoloration"
                    class="text-sm text-primary transition-colors duration-200 hover:text-primary/80 no-underline"
                  >
                    Diskoloracija
                  </a>
                </li>
                <li>
                  <a
                    href="{{ cosmetics_collection.url }}?filter.p.m.custom.problem_solution=aging"
                    class="text-sm text-primary transition-colors duration-200 hover:text-primary/80 no-underline"
                  >
                    Bore
                  </a>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <div class="ml-auto flex w-full max-w-sm min-w-150 flex-row gap-3">
          {% comment %} Quiz Banner Card {% endcomment %}
          {% liquid
            # Use global theme settings
            assign banner_title = settings.quiz_banner_title
            assign banner_description = settings.quiz_banner_description
            assign banner_image = settings.quiz_banner_image
            assign banner_overlay_color = settings.quiz_banner_overlay_color | default: '#000000'
            assign banner_overlay_opacity = settings.quiz_banner_overlay_opacity | default: 30
            assign banner_link = settings.quiz_banner_link
            assign banner_link_text = settings.quiz_banner_link_text | default: 'See our recommendations'

            # Check if banner has content
            assign banner_has_content = false
            if banner_title != blank
              assign banner_has_content = true
            elsif banner_description != blank
              assign banner_has_content = true
            endif
          %}
          {% if banner_has_content %}
            {% if banner_link != blank %}
              <a
                href="{{ banner_link }}"
                class="relative flex items-end overflow-hidden bg-black text-white rounded-xl aspect-square px-3 py-3 flex-1"
              >
            {% else %}
              <div
                class="relative flex items-end overflow-hidden bg-black text-white rounded-xl aspect-square px-3 py-3 flex-1"
              >
            {% endif %}
            <div class="absolute inset-0 z-0 overflow-hidden" aria-hidden="true">
              {% if banner_image != blank %}
                {{
                  banner_image
                  | image_url: width: 800
                  | image_tag:
                    loading: 'lazy',
                    sizes: '100vw',
                    alt: banner_title,
                    class: 'absolute inset-0 w-full h-full object-cover'
                }}
              {% else %}
                <div class="w-full h-full bg-gradient-to-r from-black/60 to-black/30"></div>
              {% endif %}
              <div
                class="absolute inset-0 pointer-events-none"
                style="background: {{ banner_overlay_color }}; opacity: {{ banner_overlay_opacity | divided_by: 100.0 }};"
              ></div>
            </div>

            <div class="relative z-10 w-full flex justify-between gap-3">
              <div>
                {% if banner_title != blank %}
                  <h2 class="font-semibold leading-snug">
                    {{ banner_title | escape }}
                  </h2>
                {% endif %}
                {% if banner_description != blank %}
                  <p class="text-xs text-white/50">
                    {{ banner_description }}
                  </p>
                {% endif %}
              </div>
              {% if banner_link != blank %}
                <div class="flex items-center text-white [&>svg]:w-5 [&>svg]:h-5">
                  {{ 'icon-chevron-right.svg' | inline_asset_content }}
                </div>
              {% endif %}
            </div>
            {% if banner_link != blank %}
              </a>
            {% else %}
              </div>
            {% endif %}
          {% endif %}

          {% comment %} Featured Item Card {% endcomment %}
          {% liquid
            assign featured_item = settings.mega_menu_featured_product
          %}
          {% if featured_item and featured_item != blank %}
            {% render 'promo-banner',
              url: featured_item.url,
              title: featured_item.title,
              description: featured_item.description,
              media: featured_item.featured_media,
              overlay_color: '#000000',
              overlay_opacity: 40
            %}
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Mega menu - Cosmetics",
  "settings": []
}
{% endschema %}
